name = "schiller-town-notes"
main = "build/index.js"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]

# Custom domain routing
routes = [
  { pattern = "schiller.town", custom_domain = true }
]

# Static assets configuration
[assets]
directory = "./public"
binding = "ASSETS"

# Environment variables
[vars]
ANTHROPIC_API_KEY = ""
IS_LOCAL_DEV = "true"

# Durable Object bindings
[[durable_objects.bindings]]
name = "MainServer"
class_name = "MainServer"

[[durable_objects.bindings]]
name = "DocumentsServer"
class_name = "DocumentsServer"

[[durable_objects.bindings]]
name = "YjsServer"
class_name = "YjsServer"

[[durable_objects.bindings]]
name = "GeoServer"
class_name = "GeoServer"

[[durable_objects.bindings]]
name = "StarChartServer"
class_name = "StarChartServer"

# Migrations - using new_sqlite_classes for free plan compatibility
[[migrations]]
tag = "v1"
new_sqlite_classes = ["MainServer", "DocumentsServer", "YjsServer", "GeoServer"]

[[migrations]]
tag = "v2"
new_sqlite_classes = ["StarChartServer"]
